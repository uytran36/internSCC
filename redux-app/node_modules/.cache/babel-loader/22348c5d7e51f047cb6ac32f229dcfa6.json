{"ast":null,"code":"import * as types from \"../constants/ActionTypes\";\nimport axios from \"axios\";\nimport * as jwt from \"jsonwebtoken\";\nimport bcrypt from \"bcryptjs\";\nexport const setCurrentUser = user => {\n  return {\n    type: types.SET_CURRENT_USER,\n    user\n  };\n};\nexport const registerRequest = user => {\n  return dispatch => {\n    const salt = bcrypt.genSaltSync(10);\n    const hassPassword = bcrypt.hashSync(user.password, salt);\n    const token = jwt.sign({\n      username: user.username,\n      password: hassPassword\n    }, \"SECRET_TOKEN\");\n    const data = {\n      username: user.username,\n      password: hassPassword,\n      token: token\n    };\n    axios.post(\"https://60b0f8b91f26610017fff943.mockapi.io/api/v1/users\", data).then(response => {\n      dispatch(register(response.data));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const register = user => {\n  return {\n    type: types.REGISTER,\n    user\n  };\n};\nexport const loginRequest = user => {\n  return dispatch => {\n    axios.get(\"https://60b0f8b91f26610017fff943.mockapi.io/api/v1/users\").then(response => {\n      dispatch(login(response.data));\n\n      for (const userInt of response.data) {\n        if (user.username === userInt.username) {\n          bcrypt.compare(user.password, userInt.password).then(valid => {\n            if (valid) {\n              const token = response.data.token;\n              window.localStorage.setItem(\"jwtToken\", token); //let temp = jwt.decode(token);\n              //delete temp[\"iat\"];\n\n              console.log(temp);\n              dispatch(setCurrentUser(temp));\n            }\n          });\n        }\n      }\n    });\n  };\n};\nexport const login = user => {\n  return {\n    type: types.LOGIN,\n    user\n  };\n};","map":{"version":3,"sources":["D:/react/redux-app/src/actions/index.js"],"names":["types","axios","jwt","bcrypt","setCurrentUser","user","type","SET_CURRENT_USER","registerRequest","dispatch","salt","genSaltSync","hassPassword","hashSync","password","token","sign","username","data","post","then","response","register","catch","err","console","log","REGISTER","loginRequest","get","login","userInt","compare","valid","window","localStorage","setItem","temp","LOGIN"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,0BAAvB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAO,KAAKC,GAAZ,MAAqB,cAArB;AACA,OAAOC,MAAP,MAAmB,UAAnB;AAEA,OAAO,MAAMC,cAAc,GAAIC,IAAD,IAAU;AACtC,SAAO;AACLC,IAAAA,IAAI,EAAEN,KAAK,CAACO,gBADP;AAELF,IAAAA;AAFK,GAAP;AAID,CALM;AAOP,OAAO,MAAMG,eAAe,GAAIH,IAAD,IAAU;AACvC,SAAQI,QAAD,IAAc;AACnB,UAAMC,IAAI,GAAGP,MAAM,CAACQ,WAAP,CAAmB,EAAnB,CAAb;AACA,UAAMC,YAAY,GAAGT,MAAM,CAACU,QAAP,CAAgBR,IAAI,CAACS,QAArB,EAA+BJ,IAA/B,CAArB;AACA,UAAMK,KAAK,GAAGb,GAAG,CAACc,IAAJ,CACZ;AACEC,MAAAA,QAAQ,EAAEZ,IAAI,CAACY,QADjB;AAEEH,MAAAA,QAAQ,EAAEF;AAFZ,KADY,EAKZ,cALY,CAAd;AAOA,UAAMM,IAAI,GAAG;AACXD,MAAAA,QAAQ,EAAEZ,IAAI,CAACY,QADJ;AAEXH,MAAAA,QAAQ,EAAEF,YAFC;AAGXG,MAAAA,KAAK,EAAEA;AAHI,KAAb;AAMAd,IAAAA,KAAK,CACFkB,IADH,CACQ,0DADR,EACoED,IADpE,EAEGE,IAFH,CAESC,QAAD,IAAc;AAClBZ,MAAAA,QAAQ,CAACa,QAAQ,CAACD,QAAQ,CAACH,IAAV,CAAT,CAAR;AACD,KAJH,EAKGK,KALH,CAKUC,GAAD,IAAS;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD,KAPH;AAQD,GAxBD;AAyBD,CA1BM;AA4BP,OAAO,MAAMF,QAAQ,GAAIjB,IAAD,IAAU;AAChC,SAAO;AACLC,IAAAA,IAAI,EAAEN,KAAK,CAAC2B,QADP;AAELtB,IAAAA;AAFK,GAAP;AAID,CALM;AAOP,OAAO,MAAMuB,YAAY,GAAIvB,IAAD,IAAU;AACpC,SAAQI,QAAD,IAAc;AACnBR,IAAAA,KAAK,CACF4B,GADH,CACO,0DADP,EAEGT,IAFH,CAESC,QAAD,IAAc;AAClBZ,MAAAA,QAAQ,CAACqB,KAAK,CAACT,QAAQ,CAACH,IAAV,CAAN,CAAR;;AACA,WAAK,MAAMa,OAAX,IAAsBV,QAAQ,CAACH,IAA/B,EAAqC;AACnC,YAAIb,IAAI,CAACY,QAAL,KAAkBc,OAAO,CAACd,QAA9B,EAAwC;AACtCd,UAAAA,MAAM,CAAC6B,OAAP,CAAe3B,IAAI,CAACS,QAApB,EAA8BiB,OAAO,CAACjB,QAAtC,EAAgDM,IAAhD,CAAsDa,KAAD,IAAW;AAC9D,gBAAIA,KAAJ,EAAW;AACT,oBAAMlB,KAAK,GAAGM,QAAQ,CAACH,IAAT,CAAcH,KAA5B;AACAmB,cAAAA,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,EAAwCrB,KAAxC,EAFS,CAGT;AACA;;AACAU,cAAAA,OAAO,CAACC,GAAR,CAAYW,IAAZ;AACA5B,cAAAA,QAAQ,CAACL,cAAc,CAACiC,IAAD,CAAf,CAAR;AACD;AACF,WATD;AAUD;AACF;AACF,KAlBH;AAmBD,GApBD;AAqBD,CAtBM;AAuBP,OAAO,MAAMP,KAAK,GAAIzB,IAAD,IAAU;AAC7B,SAAO;AACLC,IAAAA,IAAI,EAAEN,KAAK,CAACsC,KADP;AAELjC,IAAAA;AAFK,GAAP;AAID,CALM","sourcesContent":["import * as types from \"../constants/ActionTypes\";\r\nimport axios from \"axios\";\r\nimport * as jwt from \"jsonwebtoken\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nexport const setCurrentUser = (user) => {\r\n  return {\r\n    type: types.SET_CURRENT_USER,\r\n    user,\r\n  };\r\n};\r\n\r\nexport const registerRequest = (user) => {\r\n  return (dispatch) => {\r\n    const salt = bcrypt.genSaltSync(10);\r\n    const hassPassword = bcrypt.hashSync(user.password, salt);\r\n    const token = jwt.sign(\r\n      {\r\n        username: user.username,\r\n        password: hassPassword,\r\n      },\r\n      \"SECRET_TOKEN\"\r\n    );\r\n    const data = {\r\n      username: user.username,\r\n      password: hassPassword,\r\n      token: token,\r\n    };\r\n\r\n    axios\r\n      .post(\"https://60b0f8b91f26610017fff943.mockapi.io/api/v1/users\", data)\r\n      .then((response) => {\r\n        dispatch(register(response.data));\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n  };\r\n};\r\n\r\nexport const register = (user) => {\r\n  return {\r\n    type: types.REGISTER,\r\n    user,\r\n  };\r\n};\r\n\r\nexport const loginRequest = (user) => {\r\n  return (dispatch) => {\r\n    axios\r\n      .get(\"https://60b0f8b91f26610017fff943.mockapi.io/api/v1/users\")\r\n      .then((response) => {\r\n        dispatch(login(response.data))\r\n        for (const userInt of response.data) {\r\n          if (user.username === userInt.username) {\r\n            bcrypt.compare(user.password, userInt.password).then((valid) => {\r\n              if (valid) {\r\n                const token = response.data.token;\r\n                window.localStorage.setItem(\"jwtToken\", token);\r\n                //let temp = jwt.decode(token);\r\n                //delete temp[\"iat\"];\r\n                console.log(temp);\r\n                dispatch(setCurrentUser(temp));\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n  };\r\n};\r\nexport const login = (user) => {\r\n  return {\r\n    type: types.LOGIN,\r\n    user\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}